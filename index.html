<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <title>Page Title</title>
  <link href="./style.css" rel="stylesheet"/>
  
</head>

<body>
  <canvas id="the_canvas" width="800" height="600" style="border: 1px dotted gray;"></canvas>
  
  <div class="controles">
  <div class="lista">
    <label>Controles</label>
    <label>https://stackoverflow.com/questions/19245363/opengl-glut-surface-normals-of-cone</label>
    <ul>
      <li><label>W,S:</label> Rotar la camara arriba y abajo.</li>
      <li><label>A, D:</label> Rotar la camara a la izquierda y derecha.</li>
      <li><label>Q, E:</label> Alejar y acercar la camara.</li>
      <li><label>Espacio:</label> Ver wireframe.</li>
    </ul>
    </div>
    <div class="lista">
      <label>Luz</label>
      <br>
      <input type="range" min="-7" max="7" value="0" step="0.1" name="rangeX" id="rangeX" oninput="changeLightPosX(value)">
      <label for="rangeX">X</label>
      <br>
      <input type="range" min="-7" max="7" value="3" step="0.1" name="rangeY" id="rangeY" oninput="changeLightPosY(value)">
      <label for="rangeY">Y</label>
      <br>
      <input type="range" min="-7" max="7" value="0" step="0.1" name="rangeZ" id="rangeZ" oninput="changeLightPosZ(value)">
      <label for="rangeZ">Z</label>
      <br>
      <input type="checkbox" name="specular" id="specular" onchange="switchSpecular(this)">
      <label for="specular">Especular</label>
    </div>
</div>
</body>
<footer>

  <script id="2d-vertex-shader" type="vertex-shader">
    attribute vec4 a_position;
    attribute vec3 a_normal;

    uniform mat4 u_VM_matrix;
    uniform mat4 u_PVM_matrix;
    
    varying vec3 v_position;
    varying vec3 v_normal;

    void main() {
      v_normal = vec3( u_VM_matrix * vec4(a_normal, 0) );
      v_position = vec3( u_VM_matrix * a_position );

      gl_Position = u_PVM_matrix * a_position;
    }
  </script>
   
  <script id="2d-fragment-shader" type="fragment-shader">
    precision mediump float;

    //Posicion del fragmento en screenspace
    varying vec3 v_position;
    //normal del fragmento en screenspace
    varying vec3 v_normal;

    //Posicion de luz
    uniform vec3 u_light_position;
    //Color del objeto
    uniform vec4 u_color;
    //Posicion de camara
    uniform vec3 cameraPos;

    uniform bool useSpecular;
    void main() {
      
      //Ambiente
      float ambientStrength = 0.1;
      vec3 ambient = ambientStrength * vec3(0.8,0.8,1.0);

      //Difusa
      vec3 norm = normalize(v_normal);
      vec3 lightDir = normalize(u_light_position - v_position);
      float diff = max(dot(norm, lightDir), 0.0);

      vec3 diffuse = diff * vec3(1.0,1.0,1.0);

      //Especular
      float specularStrength = 1.0;
      vec3 viewDir = normalize(cameraPos - v_position);
      vec3 reflectDir = reflect(-lightDir, norm);

      float spec = pow(max(dot(viewDir, reflectDir),0.0), 16.0);
      vec3 specular = specularStrength * spec * vec3(1.0,1.0,1.0);

      vec3 result = (ambient + diffuse)*vec3(u_color);

      if(useSpecular)
      {
        result = result + specular;
      }
      gl_FragColor = vec4(result, u_color.a);
    }
  </script>

  <script src="./js/Mesh.js"></script>
  <script src="./js/Vector3.js"></script>
  <script src="./js/Vector4.js"></script>
  <script src="./js/Matrix3.js"></script>
  <script src="./js/Matrix4.js"></script>
  
  <script src="./js/PrismaRectangular.js"></script>
  
  <script src="./js/Cilindro.js"></script>
  <script src="./js/Cono.js"></script>
  <script src="./js/Esfera.js"></script>
  
  <script src="./js/Octaedro.js"></script>
  <script src="./js/Icosaedro.js"></script>
  <script src="./js/Tetraedro.js"></script>
  
  <script src="./js/Dodecaedro.js"></script>
  
  <script src="./js/Toro.js"></script>
  <script src="./js/CamaraCOI.js"></script>
  <script src="./js/Main.js"></script>

  
</footer>
</html>